var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(a,t,n)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,i=(e,a)=>{for(var t in a||(a={}))o.call(a,t)&&l(e,t,a[t]);if(n)for(var t of n(a))s.call(a,t)&&l(e,t,a[t]);return e},r=(e,n)=>a(e,t(n));import{v as d,n as u,d as c,c as m,r as p,a as v,w as f,o as b,b as h,t as g,e as y,f as w,g as x,C as $,p as N,h as k,i as _,j as C,m as T,k as V,l as E,P as S,M as I,q as O,s as L,u as P,x as D,y as M,F as R,z,A as j,B as q,D as A,I as B,E as G,X as W,G as U,L as J,H as F,J as K,K as X,N as Y,O as H,Q,R as Z,S as ee,T as ae,U as te,V as ne,W as oe,Y as se,Z as le,_ as ie,$ as re,a0 as de,a1 as ue,a2 as ce,a3 as me,a4 as pe,a5 as ve,a6 as fe,a7 as be,a8 as he,a9 as ge,aa as ye,ab as we,ac as xe,ad as $e,ae as Ne}from"./vendor.bae2ebbb.js";var ke=c({name:"VLabel",props:{tag:{type:String,default:"label"},variant:{type:String,default:"default"},size:{type:String,default:"md"},text:{type:String,default:""},hollow:{type:Boolean,default:!1}}});const _e=f("data-v-1fb90e7e"),Ce=_e(((e,a,t,n,o,s)=>(b(),m(v(e.tag),{class:{[e.size]:!0,[e.variant]:!0,hollow:e.hollow}},{default:_e((()=>[p(e.$slots,"default",{props:e.$props,attrs:e.$attrs},(()=>[h(g(e.text),1)]),!0)])),_:3},8,["class"]))));ke.render=Ce,ke.__scopeId="data-v-1fb90e7e";var Te=c({name:"VButton",components:{VLabel:ke}});const Ve=f("data-v-40aaf7c1"),Ee=Ve(((e,a,t,n,o,s)=>{const l=w("v-label");return b(),m(l,{tag:"button",onKeyup:a[1]||(a[1]=y(x((e=>e.target.click()),["exact"]),["enter"]))},{default:Ve((({props:a})=>[p(e.$slots,"default",{},(()=>[h(g(a.text),1)]),{})])),_:3})}));Te.render=Ee,Te.__scopeId="data-v-40aaf7c1";var Se=c({name:"VCheckbox",components:{CheckIcon:$,VLabel:ke},inheritAttrs:!1,props:{labelAttrs:{type:Object,default:()=>({})},modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup:(e,{emit:a})=>({update:e=>{a("update:modelValue",e.target.checked)}})});const Ie=f("data-v-a5dde71e");N("data-v-a5dde71e");const Oe={class:"box"},Le={key:0};k();const Pe=Ie(((e,a,t,n,o,s)=>{const l=w("check-icon"),i=w("v-label");return b(),m(i,T({class:{disabled:e.$attrs.disabled},size:e.$attrs.size,variant:e.$attrs.variant,text:e.$attrs.text,hollow:e.$attrs.hollow,tabindex:e.$attrs.disabled?-1:0},e.labelAttrs,{onKeyup:a[2]||(a[2]=y(x((e=>e.target.click()),["exact"]),["enter"]))}),{default:Ie((({props:t})=>[_("input",{type:"checkbox",disabled:e.$attrs.disabled,checked:e.modelValue,onChange:a[1]||(a[1]=(...a)=>e.update&&e.update(...a))},null,40,["disabled","checked"]),_("span",Oe,[_(l,{class:"text-black"})]),t.text?(b(),m("span",Le,g(t.text),1)):C("",!0)])),_:1},16,["class","size","variant","text","hollow","tabindex"])}));Se.render=Pe,Se.__scopeId="data-v-a5dde71e";var De=c({name:"VInput",components:{VLabel:ke},props:{type:{type:String,default:"text"},modelValue:{type:String,default:null},hollow:{type:Boolean,default:!1}},emits:["update:modelValue"]});const Me=f("data-v-d3c91e3a"),Re=Me(((e,a,t,n,o,s)=>{const l=w("v-label");return b(),m(l,T({tag:"input",type:e.type,value:e.modelValue},e.$attrs,{hollow:!0,onInput:a[1]||(a[1]=a=>e.$emit("update:modelValue",a.target.value))}),{default:Me((()=>[])),_:1},16,["type","value"])}));De.render=Re,De.__scopeId="data-v-d3c91e3a";var ze=c({name:"VGroup",props:{tag:{type:String,default:"div"},variant:{type:String,default:"default"},size:{type:String,default:"md"},hollow:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},vertical:{type:Boolean,default:!1},modelValue:{type:Object,default:()=>({})},modelValueMapping:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup:(e,{slots:a,emit:t})=>()=>{var n;let o=0;return V(e.tag,{class:{vertical:e.vertical,group:!0}},null==(n=a.default)?void 0:n.call(a).map(((n,s)=>{var l,d,u,c,m,p,v,f,b,h,g,y,w;if(n.type===E)return o++,n;{const x=s-o;return V(n,{size:e.size,variant:null!=(d=null==(l=n.props)?void 0:l.variant)?d:e.variant,hollow:null!=(c=null==(u=n.props)?void 0:u.hollow)?c:e.hollow,disabled:e.disabled||(null==(m=n.props)?void 0:m.disabled),modelValue:null!=(h=null!=(f=null==(p=n.props)?void 0:p.modelValue)?f:null==(v=n.props)?void 0:v["model-value"])?h:e.modelValue[null!=(b=e.modelValueMapping[x])?b:s],"onUpdate:modelValue":null!=(y=null==(g=n.props)?void 0:g["onUpdate:modelValue"])?y:void 0!==e.modelValue&&(a=>{var n;return t("update:modelValue",r(i({},e.modelValue),{[null!=(n=e.modelValueMapping[x])?n:x]:a}))}),class:(0===x?"group-item-start":x===((null==(w=a.default)?void 0:w.call(a).length)||1)-o?"group-item-end":"group-item")+(e.vertical?"-vertical":"")})}})))}});ze.__scopeId="data-v-6fe0e4c2";var je=c({name:"VNumber",components:{VInput:De,VButton:Te,VInputGroup:ze,PlusIcon:S,MinusIcon:I},props:{variant:{type:String,default:"default"},size:{type:String,default:"md"},hollow:{type:Boolean,default:!1},modelValue:{type:Number,default:null},value:{type:Number,default:null},placeholder:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:a}){const t=O();return{add:e=>{var n;(null==(n=t.value)?void 0:n.$el)&&(0===e&&""===t.value.$el.value||(isNaN(+t.value.$el.value)?t.value.$el.value=t.value.$el.value.replace(/[^0-9](?<!^-)/,""):t.value.$el.value=+t.value.$el.value+e),a("update:modelValue",t.value.$el.value&&!isNaN(+t.value.$el.value)?+t.value.$el.value:null))},input:t}}});je.render=function(e,a,t,n,o,s){const l=w("v-input"),i=w("minus-icon"),r=w("v-button"),d=w("plus-icon"),u=w("v-input-group");return b(),m(u,null,{default:L((()=>{var t;return[_(l,T({variant:e.variant,size:e.size,placeholder:e.placeholder},{ref:"input",value:null!=(t=e.modelValue)?t:e.value,onInput:a[1]||(a[1]=a=>e.add(0)),onKeydown:[a[2]||(a[2]=y(x((a=>e.add(1)),["prevent","exact"]),["up"])),a[3]||(a[3]=y(x((a=>e.add(-1)),["prevent","exact"]),["down"]))]}),null,16,["value"]),_(r,T({variant:e.variant,size:e.size,hollow:e.hollow},{onClick:a[4]||(a[4]=a=>e.add(-1))}),{default:L((()=>[_(i)])),_:1},16),_(r,T({variant:e.variant,size:e.size,hollow:e.hollow},{onClick:a[5]||(a[5]=a=>e.add(1))}),{default:L((()=>[_(d)])),_:1},16)]})),_:1})};var qe=c({name:"VSuggest",components:{VButton:Te,VInput:De,VGroup:ze},inheritAttrs:!1,props:{variant:{type:String,default:"default"},size:{type:String,default:"md"},hollow:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},modelValue:{type:String,default:null},options:{type:Array,required:!0}},emits:["update:modelValue"],setup(e,{emit:a}){const t=O(),n=P((()=>{const a=e.options.map((a=>{var t;return[a,a.toLowerCase().indexOf(null==(t=e.modelValue)?void 0:t.toLowerCase())]})),t=a.filter((e=>e[1]>-1));return(t.length?t:a).sort(((e,a)=>e[1]>a[1]?1:e[1]<a[1]?-1:e[0]>a[0]?1:-1)).map((e=>e[0]))})),o=O(!1),s=O(-1),l={start(){o.value=!0},finish(){t.value&&t.value.$el.querySelector(".active")&&t.value.$el.querySelector(".active").scrollIntoView({behavior:"auto",block:"nearest",inline:"nearest"})},up(){l.start(),s.value>0?s.value-=1:s.value=n.value.length,l.finish()},down(){l.start(),s.value<n.value.length-1?s.value+=1:s.value=-1,l.finish()},end(){l.start(),s.value=n.value.length-1,l.finish()},home(){l.start(),s.value=0,l.finish()},choose(){var t;a("update:modelValue",null!=(t=n.value[s.value])?t:e.modelValue)}};return{filteredOptions:n,showDrop:o,suggestionSelected:s,suggestionNavigation:l}}});const Ae=f("data-v-0cff62ff"),Be=Ae(((e,a,t,n,o,s)=>{const l=w("v-input"),r=w("v-button"),d=w("v-group");return b(),m("div",{class:{wrapper:!0,[e.variant]:!0,[e.size]:!0,hollow:e.hollow}},[_(l,T(i({variant:e.variant,size:e.size,hollow:e.hollow},e.$attrs),{class:"rounded-within","model-value":e.modelValue,"onUpdate:modelValue":a[1]||(a[1]=a=>e.$emit("update:modelValue",a)),onFocus:a[2]||(a[2]=()=>e.showDrop=!0),onBlur:a[3]||(a[3]=()=>e.showDrop=!1),onInput:a[4]||(a[4]=()=>e.suggestionSelected=-1),onKeydown:[y(x(e.suggestionNavigation.up,["prevent"]),["up"]),y(x(e.suggestionNavigation.down,["prevent"]),["down"]),y(x(e.suggestionNavigation.end,["prevent"]),["end"]),y(x(e.suggestionNavigation.home,["prevent"]),["home"]),y(x(e.suggestionNavigation.choose,["prevent"]),["enter"])]}),null,16,["model-value","onKeydown"]),D(_(d,T({variant:e.variant,size:e.size,hollow:e.hollow},{tag:"ul",class:{[e.size]:!0},vertical:""}),{default:Ae((()=>[(b(!0),m(R,null,z(e.filteredOptions,((a,t)=>(b(),m(r,{key:`${a} - ${t}`,class:{active:t==e.suggestionSelected},tag:"li",onMouseover:()=>e.suggestionSelected=t,onMousedown:()=>{e.suggestionSelected=t,e.suggestionNavigation.choose()}},{default:Ae((()=>[h(g(a),1)])),_:2},1032,["class","onMouseover","onMousedown"])))),128))])),_:1},16,["class"]),[[M,e.showDrop]])],2)}));qe.render=Be,qe.__scopeId="data-v-0cff62ff";var Ge=c({name:"VField",components:{VCheckbox:Se,VInput:De,VNumber:je,VSuggest:qe},props:{label:{type:String,required:!0},required:{type:Boolean,default:!1},input:{type:String,default:"input"},inputProps:{type:Object,default:()=>({})},modelValue:{type:[Object,String,Boolean,Array,Number],default:null},issues:{type:Array,default:()=>[]},primary:{type:Boolean,default:!1}},emits:["update:modelValue"],setup:e=>({status:P((()=>e.issues.find((e=>"error"===e.type))?"error":e.issues.find((e=>"warning"===e.type))?"warning":e.issues.find((e=>"success"===e.type))?"success":e.primary?"primary":""))})});const We=f("data-v-9741f0da");N("data-v-9741f0da");const Ue={class:"field"},Je={key:0,class:{"text-primary":!0}};k();const Fe=We(((e,a,t,n,o,s)=>(b(),m("label",Ue,[_("span",null,[p(e.$slots,"label",{},(()=>[_("span",{class:{[e.status]:!0}},g(e.label),3),e.required?(b(),m("span",Je," *")):C("",!0)]),{})]),p(e.$slots,"default",{modelValue:e.modelValue,"onUpdate:modelValue":a[1]||(a[1]=a=>e.$emit("update:modelValue",a))},(()=>[(b(),m(v(`v-${e.input}`),T(e.inputProps,{"model-value":e.modelValue,variant:e.status,"onUpdate:modelValue":a[2]||(a[2]=a=>e.$emit("update:modelValue",a))}),null,16,["model-value","variant"]))]),!0),(b(!0),m(R,null,z(e.issues,((e,a)=>(b(),m("span",{key:e.message+a,class:[e.type,"issue"]},g(e.message),3)))),128))]))));Ge.render=Fe,Ge.__scopeId="data-v-9741f0da";var Ke=c({name:"VMessage",components:{VLabel:ke,CircleCheckIcon:j,AlertCircleIcon:q,CircleXIcon:A,InfoCircleIcon:B,MessageCircleIcon:G},props:{status:{type:String,default:"primary"},body:{type:String,required:!0}}});const Xe=f("data-v-130d25ea"),Ye=Xe(((e,a,t,n,o,s)=>{const l=w("message-circle-icon"),i=w("circle-check-icon"),r=w("alert-circle-icon"),d=w("info-circle-icon"),u=w("circle-x-icon"),c=w("v-label");return b(),m(c,{class:"shadow-lg",tag:"div",variant:e.status},{default:Xe((()=>["primary"===e.status?(b(),m(l,{key:0})):C("",!0),"success"===e.status?(b(),m(i,{key:1})):C("",!0),"warning"===e.status?(b(),m(r,{key:2})):C("",!0),"info"===e.status?(b(),m(d,{key:3})):C("",!0),"error"===e.status?(b(),m(u,{key:4})):C("",!0),_("span",null,g(e.body),1)])),_:1},8,["variant"])}));Ke.render=Ye,Ke.__scopeId="data-v-130d25ea";var He=c({name:"VDialog",components:{VLabel:ke,VButton:Te,VInput:De,CircleCheckIcon:j,AlertCircleIcon:q,CircleXIcon:A,XIcon:W,MessageCircleIcon:G},props:{mode:{type:String,required:!0},header:{type:String,default:null},body:{type:String,default:null},negative:{type:String,default:null},positive:{type:String,default:null},positiveVariant:{type:String,default:null},mask:{type:Boolean,default:!1},initialPrompt:{type:String,default:""}},emits:["positive","negative","finish"],setup(e){const a=P((()=>"confirm"===e.mode?"warning":"prompt"===e.mode?"primary":e.mode)),t=O(e.initialPrompt),n=O(),o=O(),s=O();return U((()=>{var e,a;const t=null!=(a=null!=(e=n.value)?e:o.value)?a:s.value;t&&t.$el.focus()})),{variant:a,inputValue:t,inputRef:n,negataveRef:o,positiveRef:s}}});const Qe=f("data-v-23222403");N("data-v-23222403");const Ze=_("div",null,null,-1);k();const ea=Qe(((e,a,t,n,o,s)=>{const l=w("circle-check-icon"),i=w("alert-circle-icon"),r=w("circle-x-icon"),d=w("message-circle-icon"),u=w("x-icon"),c=w("v-button"),v=w("v-input"),f=w("v-label");return b(),m("div",{class:{mask:e.mask},onClick:a[5]||(a[5]=x((a=>e.$emit("negative")||e.$emit("finish")),["self"])),onKeydown:a[6]||(a[6]=y((a=>e.$emit("negative")||e.$emit("finish")),["esc"]))},[_(f,{tag:"div",class:"dialog",variant:e.variant,hollow:""},{default:Qe((()=>{var t,n,o,s;return[_("header",null,["success"===e.mode?(b(),m(l,{key:0})):C("",!0),"confirm"===e.mode?(b(),m(i,{key:1})):C("",!0),"error"===e.mode?(b(),m(r,{key:2})):C("",!0),"prompt"===e.mode?(b(),m(d,{key:3})):C("",!0),_("span",null,g(null!=(t=e.header)?t:e.mode),1),_(c,{variant:"text",class:"close",onClick:a[1]||(a[1]=a=>e.$emit("negative")||e.$emit("finish"))},{default:Qe((()=>[_(u)])),_:1})]),_("main",null,[p(e.$slots,"body",{},(()=>[h(g(e.body),1)]),{}),"prompt"===e.mode?(b(),m(v,{key:0,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":a[2]||(a[2]=a=>e.inputValue=a),variant:"primary"},null,8,["modelValue"])):C("",!0)]),_("footer",null,[e.negative||["prompt","confirm"].includes(e.mode)?(b(),m(c,{key:0,ref:"negativeRef",text:null!=(n=e.negative)?n:"cancel",onClick:a[3]||(a[3]=a=>e.$emit("negative")||e.$emit("finish"))},null,8,["text"])):C("",!0),_(c,{ref:"positive",variant:null!=(o=e.positiveVariant)?o:["confirm","prompt"].includes(e.mode)?"success":e.mode,class:"col-start-2",text:null!=(s=e.positive)?s:["prompt","confirm"].includes(e.mode)?"Ok":"Got it",onClick:a[4]||(a[4]=a=>e.$emit("positive",e.inputValue)||e.$emit("finish"))},null,8,["variant","text"])])]})),_:3},8,["variant"]),Ze],34)}));He.render=ea,He.__scopeId="data-v-23222403";var aa=c({props:{trigger:{type:String,default:"click"},hiddenWrapperAttrs:{type:Object,default:()=>({})}},setup:()=>({show:O(!1)})});const ta=f("data-v-f2934dc2")(((e,a,t,n,o,s)=>(b(),m("div",{onClick:a[2]||(a[2]=a=>"click"===e.trigger&&(e.show=!e.show)),onMouseover:a[3]||(a[3]=a=>"hover"===e.trigger&&(e.show=!0)),onMouseleave:a[4]||(a[4]=a=>e.show=!1)},[p(e.$slots,"default",{onClick:a[1]||(a[1]=a=>e.$console.log("test"))},void 0,!0),_("div",T({class:{"hidden-wrapper":!0,hidden:!e.show}},e.hiddenWrapperAttrs),[p(e.$slots,"hidden",{},void 0,!0)],16)],32))));aa.render=ta,aa.__scopeId="data-v-f2934dc2";var na=c({components:{VButton:Te,VGroup:ze,PlusIcon:S,LayoutColumnsIcon:J,LayoutRowsIcon:F},setup(){const e=K(),a=P((()=>e.state.modifications));return{open:O(!0),tables:a}}});const oa=f("data-v-8ecd2692");N("data-v-8ecd2692");const sa=_("span",null," Tables ",-1),la={class:"overflow-hidden ellipsis block"},ia={key:0},ra=_("span",null,"Columns",-1),da=_("span",null,"Data",-1);k();const ua=oa(((e,a,t,n,o,s)=>{const l=w("plus-icon"),i=w("v-button"),r=w("layout-columns-icon"),d=w("layout-rows-icon"),u=w("v-group"),c=w("router-link");return b(),m("aside",{class:{closed:!e.open}},[_("main",null,[_("header",null,[sa,_(i,{disabled:!e.$store.state.database,variant:"text",size:"sm",onClick:a[1]||(a[1]=()=>e.$store.dispatch("createModification").then((a=>e.$router.push(`/table/${a}`))))},{default:oa((()=>[_(l)])),_:1},8,["disabled"])]),(b(!0),m(R,null,z(e.tables,((e,a)=>(b(),m(c,{key:a,to:{name:"Table",params:{name:a}}},{default:oa((t=>[_("span",la,[h(g(a)+" ",1),(null==e?void 0:e.new)?(b(),m("span",ia,"(not real)")):C("",!0)]),t.isActive?(b(),m(u,{key:0,class:"ml-4 mt-2",variant:"primary",size:"sm",vertical:!0},{default:oa((()=>[_(i,{style:{"justify-content":"space-between"},tag:"router-link",to:{name:"TableColumns"}},{default:oa((()=>[ra,_(r)])),_:1}),(null==e?void 0:e.new)?C("",!0):(b(),m(i,{key:0,style:{"justify-content":"space-between"},tag:"router-link",to:{name:"TableData"}},{default:oa((()=>[da,_(d)])),_:1}))])),_:2},1024)):C("",!0)])),_:2},1032,["to"])))),128))]),_("div",{class:{toggle:!0,open:!e.open},onClick:a[2]||(a[2]=a=>e.open=!e.open)},null,2)],2)}));na.render=ua,na.__scopeId="data-v-8ecd2692";var ca=c({components:{separator:()=>V("span",{class:"text-2xl text-primary"},"/"),VButton:Te,VDropdown:aa,VGroup:ze},setup(){const e=K(),a=X(),t=Y(),n=H("dialog");return{databaseName:P((()=>{var a;return null==(a=e.state.database)?void 0:a.name})),renameDatabase:function(){var o;n&&n.prompt("",{title:"Rename database",initialPrompt:null==(o=e.state.database)?void 0:o.name,onPositive:n=>{e.commit("setDatabase",r(i({},e.state.database),{name:n})),a.replace(t.path)}})},tableNames:P((()=>Object.keys(e.state.modifications)))}}});const ma=f("data-v-aa5b650a");N("data-v-aa5b650a");const pa={class:"breadcrumbs z-30"};k();const va=ma(((e,a,t,n,o,s)=>{var l;const i=w("v-button"),r=w("separator"),d=w("v-group"),u=w("v-dropdown");return b(),m("div",pa,[e.databaseName?(b(),m(R,{key:0},[_(i,{variant:"text",size:"sm",text:e.databaseName,onClick:e.renameDatabase},null,8,["text","onClick"]),_(r)],64)):C("",!0),_(u,{"hidden-wrapper-attrs":{class:"min-w-full"}},{hidden:ma((()=>[_(d,{vertical:!0},{default:ma((()=>[_(i,{tag:"router-link",text:"Home",to:"/"}),_(u,{trigger:"hover","hidden-wrapper-attrs":{style:"left: 100%; top: 0;",class:"max-h-40 overflow-y-auto overflow-x-hidden"}},{hidden:ma((()=>[_(d,{vertical:!0},{default:ma((()=>[(b(!0),m(R,null,z(e.tableNames,(e=>(b(),m(i,{key:e,tag:"router-link",text:e,to:{name:"Table",params:{name:e}}},null,8,["text","to"])))),128))])),_:1})])),default:ma((()=>[_(i,{text:"Table",class:"w-full rounded-t-none",style:{"justify-content":"start"}})])),_:1})])),_:1})])),default:ma((()=>{var a;return[_(i,{variant:"text",class:"items-center",size:"sm",text:(null==(a=e.$route.name)?void 0:a.startsWith("Table"))?`Table - ${e.$route.params.name}`:e.$route.name},null,8,["text"])]})),_:1}),(null==(l=e.$route.name)?void 0:l.startsWith("Table"))?(b(),m(R,{key:1},[_(r),_("div",null,[_(u,null,{hidden:ma((()=>[_(d,{vertical:!0},{default:ma((()=>{var a,t;return[_(i,{tag:"router-link",size:"sm",text:"Columns",to:{name:"TableColumns"}}),(null==(t=e.$store.state.modifications[null==(a=e.$route.params)?void 0:a.name])?void 0:t.new)?C("",!0):(b(),m(i,{key:0,tag:"router-link",size:"sm",text:"Data",to:{name:"TableData"}}))]})),_:1})])),default:ma((()=>[_(i,{variant:"text",size:"sm",text:e.$route.name.substring(5),class:"table-name"},null,8,["text"])])),_:1})])],64)):C("",!0)])}));ca.render=va,ca.__scopeId="data-v-aa5b650a";var fa=c({components:{VButton:Te,DatabaseImportIcon:Q,DatabaseIcon:Z,DatabaseExportIcon:ee,InfoCircleIcon:B,TheBreadcrumbs:ca},setup(){const e=K(),a=H("dialog");return{sqlJsReady:P((()=>!!e.state.sqlJs)),databaseReady:P((()=>!!e.state.sqlJs&&!!e.state.database)),openDatabase:()=>e.dispatch("openDatabase"),newDatabase:()=>e.dispatch("createDatabase"),saveDatabase:()=>e.dispatch("saveDatabase"),showInfo:function(){if(a&&e.state.sqlJs){const t=(new e.state.sqlJs.Database).exec("SELECT sqlite_version()")[0].values[0][0];a.success(`SQLite version v${t}`,{header:"SQLite Version"})}}}}});const ba=f("data-v-37e94147");N("data-v-37e94147");const ha=_("img",{src:"/assets/logo.9bfa92a2.png",class:"p-1.5"},null,-1),ga=_("span",null,"Web Edit DB",-1),ya={class:"controlls"},wa=_("span",null," New ",-1),xa=_("span",null," Open ",-1),$a=_("span",null," save ",-1);k();const Na=ba(((e,a,t,n,o,s)=>{const l=w("router-link"),i=w("the-breadcrumbs"),r=w("database-icon"),d=w("v-button"),u=w("database-import-icon"),c=w("database-export-icon"),p=w("info-circle-icon");return b(),m("nav",null,[_(l,{to:"/",custom:""},{default:ba((({navigate:e})=>[_("h1",{onClick:e},[ha,ga],8,["onClick"])])),_:1}),_(i),_("div",ya,[_(d,{disabled:!e.sqlJsReady,variant:"warning",hollow:"",onClick:e.newDatabase},{default:ba((()=>[_(r,{class:"p-0.5"}),wa])),_:1},8,["disabled","onClick"]),_(d,{disabled:!e.sqlJsReady,variant:"warning",hollow:"",onClick:e.openDatabase},{default:ba((()=>[_(u,{class:"p-0.5"}),xa])),_:1},8,["disabled","onClick"]),_(d,{disabled:!e.databaseReady,variant:"primary",onClick:e.saveDatabase},{default:ba((()=>[_(c,{class:"p-0.5"}),$a])),_:1},8,["disabled","onClick"]),_(d,{variant:"text",onClick:e.showInfo},{default:ba((()=>[_(p)])),_:1},8,["onClick"])])])}));function ka(e={}){const{immediate:a=!0,onNeedRefresh:t,onOfflineReady:n}=e,o=O(!1),s=O(!1);return{updateServiceWorker:function(e={}){const{immediate:a=!1,onNeedRefresh:t,onOfflineReady:n}=e;let o,s;if("serviceWorker"in navigator){o=new d("/sw.js",{scope:"/"}),o.addEventListener("activated",(e=>{e.isUpdate||null==n||n()}));{const e=()=>{null==t||t()};o.addEventListener("waiting",e),o.addEventListener("externalwaiting",e)}o.register({immediate:a}).then((e=>s=e))}return async(e=!0)=>{e&&(null==o||o.addEventListener("controlling",(e=>{e.isUpdate&&window.location.reload()}))),s&&s.waiting&&await u(s.waiting,{type:"SKIP_WAITING"})}}({immediate:a,onNeedRefresh(){o.value=!0,null==t||t()},onOfflineReady(){s.value=!0,null==n||n()}}),offlineReady:s,needRefresh:o}}fa.render=Na,fa.__scopeId="data-v-37e94147";const _a=e=>new Promise((a=>setTimeout(a,e)));var Ca=c({components:{TheSide:na,TheNavigation:fa,VMessage:Ke,VDialog:He},setup(){const e=K(),a=ae({ref:void 0,percentages:{},async start(e,{limit:a,current:t}={}){this.percentages[e]={limit:a||80,current:t||0}},async finish(e){e in this.percentages||await this.start(e),this.ref&&1===Object.values(this.percentages).length?(this.percentages[e].current=100,await _a(400),this.ref.style.transition="none",delete this.percentages[e],await _a(40),this.ref.style.transition=""):delete this.percentages[e]},async error(e){this.ref&&(this.percentages[e].current<20&&await _a(1e3),this.ref.classList.add("error"),await this.finish(e),this.ref.classList.remove("error"))},get percentage(){return se(Object.values(this.percentages).map((e=>e.current)))||0},increment(){for(const e in this.percentages){const a=this.percentages[e];a.current<a.limit&&a.current++}}});te("loading",a);const t=setInterval((()=>a.increment()),210);ne((()=>clearInterval(t)));const n=ae({ref:void 0,messages:[],async remove(e){this.messages=this.messages.filter((a=>a.id!==e))},async push(e){var a,t;const n=(null!=(t=null==(a=this.messages[this.messages.length-1])?void 0:a.id)?t:-1)+1;this.messages.push(r(i({},e),{id:n})),setTimeout((()=>this.remove(n)),3e3)},async primary(e){this.push({body:e,status:"primary"})},async success(e){this.push({body:e,status:"success"})},async error(e){this.push({body:e,status:"error"})},async warning(e){this.push({body:e,status:"error"})}});te("message",n);const o=ae({dialogs:[],remove(e){this.dialogs=this.dialogs.filter((a=>a.id!==e))},async confirm(e,a){var t,n;const o=(null!=(n=null==(t=this.dialogs[this.dialogs.length-1])?void 0:t.id)?n:-1)+1;this.dialogs.push(r(i({id:o,body:e},a),{mode:"confirm",onFinish:()=>this.remove(o)}))},async success(e,a){var t,n;const o=(null!=(n=null==(t=this.dialogs[this.dialogs.length-1])?void 0:t.id)?n:-1)+1;this.dialogs.push(r(i({id:o,body:e},a),{mode:"success",onFinish:()=>this.remove(o)}))},async error(e,a){var t,n;const o=(null!=(n=null==(t=this.dialogs[this.dialogs.length-1])?void 0:t.id)?n:-1)+1;this.dialogs.push(r(i({id:o,body:e},a),{mode:"error",onFinish:()=>this.remove(o)}))},async prompt(e,a){var t,n;const o=(null!=(n=null==(t=this.dialogs[this.dialogs.length-1])?void 0:t.id)?n:-1)+1;this.dialogs.push(r(i({id:o,body:e},a),{mode:"prompt",onFinish:()=>this.remove(o)}))}});te("dialog",o),U((()=>{window.$loading=a,window.$message=n,window.$dialog=o})),a.start("sql.js"),oe({locateFile:e=>`/assets/${e}`}).then((t=>{var n;const o=JSON.parse(null!=(n=sessionStorage.getItem("vuex-tab-preserve"))?n:"null");o&&e.replaceState(r(i(i({},e.state),o),{database:r(i({},o.database),{connection:new t.Database(Uint8Array.from(o.database.connection.split(",")))})})),e.commit("setSqlJs",t),e.dispatch("queryTables"),a.finish("sql.js")})).catch((e=>{a.error("sql.js"),console.error("Falied to load the database engine.\n          Please refresh the page."),console.error(e)}));const{updateServiceWorker:s}=ka({onOfflineReady:()=>n.success("Web Edit DB works offline!"),onNeedRefresh(){o.confirm("There is a new version of Web Edit DB!",{header:"Update",onPositive(){s()},positive:"Reload"})}});return{loading:a,message:n,dialog:o}}});const Ta={id:"dialog-manager"};Ca.render=function(e,a,t,n,o,s){const l=w("the-navigation"),d=w("the-side"),u=w("router-view"),c=w("v-message"),p=w("v-dialog");return b(),m(R,null,[_(l),_(d),_("main",null,[_(u,{key:e.$route.path})]),_("div",{id:"loading-bar",ref:a=>e.loading.ref=a,style:{maxWidth:`${e.loading.percentage}%`}},null,4),(b(),m(le,{to:"body"},[_(ie,{id:"message-manager",tag:"div",name:"message-manager"},{default:L((()=>[(b(!0),m(R,null,z(e.message.messages,(e=>(b(),m(c,T({key:e.id},r(i({},e),{id:void 0})),null,16)))),128))])),_:1})])),(b(),m(le,{to:"body"},[_("div",Ta,[(b(!0),m(R,null,z(e.dialog.dialogs,((a,t)=>D((b(),m(p,T({key:a.id},r(i({},a),{id:void 0,body:"function"==typeof a.body?void 0:a.body}),{mask:!0}),re({_:2},["function"==typeof a.body?{name:"body",fn:L((()=>[(b(),m(v(a.body)))]))}:void 0]),1040)),[[M,t===e.dialog.dialogs.length-1]]))),128))])]))],64)};let Va;const Ea={},Sa=function(e,a){if(!a||0===a.length)return e();if(void 0===Va){const e=document.createElement("link").relList;Va=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(a.map((e=>{if((e=`/${e}`)in Ea)return;Ea[e]=!0;const a=e.endsWith(".css"),t=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${t}`))return;const n=document.createElement("link");return n.rel=a?"stylesheet":Va,a||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),a?new Promise(((e,a)=>{n.addEventListener("load",e),n.addEventListener("error",a)})):void 0}))).then((()=>e()))};var Ia=c({name:"Home"});const Oa=f("data-v-1f390d79");N("data-v-1f390d79");const La={class:"home"},Pa=_("img",{alt:"Vue logo",src:"/assets/logo.9bfa92a2.png"},null,-1),Da=_("h1",null,"Web Edit DB",-1),Ma=_("p",null," Web Edit DB is a free browser-based SQLite database editor. ",-1);k();const Ra=Oa(((e,a,t,n,o,s)=>(b(),m("div",La,[Pa,Da,Ma]))));Ia.render=Ra,Ia.__scopeId="data-v-1f390d79";var za=c({props:{start:{type:Object,required:!0},end:{type:Object,required:!0}},setup(e){const a=P((()=>[e.start,{x:e.start.x+(e.start.x>e.end.x?-100:100),y:e.start.y},{x:e.end.x+(e.start.x<e.end.x?-100:100),y:e.end.y},e.end]));de((()=>a.value),(()=>console.log("updated!")),{immediate:!0});return{svgPath:P((()=>`M${a.value[0].x} ${a.value[0].y} `+a.value.slice(1).map((e=>`L${e.x} ${e.y}`)).join(" ")))}}});const ja=f("data-v-86fa9f0c")(((e,a,t,n,o,s)=>(b(),m(le,{to:"#graph-path-layer"},[_("path",{d:e.svgPath,fill:"none"},null,8,["d"])]))));za.render=ja,za.__scopeId="data-v-86fa9f0c";var qa=c({components:{GraphPath:za},props:{columnName:{type:String,required:!0},tableName:{type:String,required:!0}},setup(e){const a=K();return{column:P((()=>a.state.modifications[e.tableName].columns[e.columnName])),tableColumnPositions:H("tableColumnPositions")}}});const Aa=f("data-v-39d50f33");N("data-v-39d50f33");const Ba={class:"name"},Ga={class:"properties"},Wa={key:0,class:"property"},Ua={key:1,class:"property"},Ja={key:2,class:"property"},Fa={class:"property"};k();const Ka=Aa(((e,a,t,n,o,s)=>{var l;const i=w("graph-path");return b(),m("div",{key:e.column.name,class:"graph-table-column"},[_("div",Ba,g(e.column.name),1),_("div",Ga,[e.column.notNull?(b(),m("div",Wa," NN ")):C("",!0),e.column.unique?(b(),m("div",Ua," UN ")):C("",!0),e.column.primaryKey?(b(),m("div",Ja," PK ")):C("",!0),_("div",Fa,g(e.column.type),1)]),e.column.foreign.table&&e.column.foreign.column&&e.tableColumnPositions[e.tableName]?(b(),m(i,{key:0,start:e.tableColumnPositions[e.tableName][e.columnName],end:null==(l=e.tableColumnPositions[e.column.foreign.table])?void 0:l[e.column.foreign.column]},null,8,["start","end"])):C("",!0)])}));qa.render=Ka,qa.__scopeId="data-v-39d50f33";const Xa={cell:20,cellLarge:100,size:1e4};var Ya=c({components:{GraphTableColumn:qa,PaletteIcon:ue,VButton:Te},props:{tableName:{type:String,required:!0}},setup(e){const a=K(),t=P((()=>{var t,n;return null!=(n=null==(t=a.state.modifications[e.tableName])?void 0:t.columns)?n:{}})),n=H("controlls"),o=P((()=>({w:160,h:(Object.keys(t.value).length+1)*Xa.cell*2}))),s=O({x:0,y:0,h:0,w:0}),l=H("tableColumnPositions");return de([t,s],(()=>{l.value[e.tableName]=Object.fromEntries(Object.entries(t.value).map((([e],a)=>[e,{x:s.value.x+o.value.w/2,y:s.value.y+2*Xa.cell*(a+1.5)}])))})),de(s,(()=>a.commit("setGraphTablePosition",{tableName:e.tableName,position:s.value})),{flush:"post"}),U((()=>{var t,n,l,d,u,c;a.state.modifications[e.tableName].new||a.dispatch("queryColumns",e.tableName),s.value=r(i({},o.value),{x:null!=(l=null==(n=null==(t=a.state.graph.tables)?void 0:t[e.tableName])?void 0:n.x)?l:200*Object.keys(a.state.graph.tables).length,y:null!=(c=null==(u=null==(d=a.state.graph.tables)?void 0:d[e.tableName])?void 0:u.y)?c:0}),a.commit("setGraphTablePosition",{tableName:e.tableName,position:s.value})})),{columns:t,controlls:n,size:o,position:s,getPosition:()=>s,tableColumnPositions:l}}});const Ha=f("data-v-4aeae716"),Qa=Ha(((e,a,t,n,o,s)=>{const l=w("palette-icon"),i=w("v-button"),r=w("graph-table-column");return b(),m("foreignObject",{height:e.position.h,width:e.position.w,x:e.position.x,y:e.position.y},[_("div",{class:"graph-table",onMousedown:a[1]||(a[1]=()=>{e.controlls.target={position:e.getPosition,grid:!0,table:e.tableName}}),onMouseup:a[2]||(a[2]=a=>e.controlls.target=null)},[_("header",null,[_("span",null,g(e.tableName),1),_(i,{variant:"text",size:"sm"},{default:Ha((()=>[_(l)])),_:1})]),(b(!0),m(R,null,z(e.columns,((a,t)=>(b(),m(r,{key:t,"column-name":t,"table-name":e.tableName},null,8,["column-name","table-name"])))),128))],32)],8,["height","width","x","y"])}));Ya.render=Qa,Ya.__scopeId="data-v-4aeae716";var Za=c({components:{GraphTable:Ya},setup(){const e=K();return{tables:P((()=>e.state.modifications)),tablePositions:H("tablePositions")}}});Za.render=function(e,a,t,n,o,s){const l=w("graph-table");return b(),m("g",null,[(b(!0),m(R,null,z(e.tables,((a,t)=>(b(),m(l,{key:t,ref:a=>{var n;return e.tablePositions[t]=r(i({},null!=(n=null==a?void 0:a.position)?n:{x:0,y:0,w:0,h:0}),{name:null==a?void 0:a.tableName})},"table-name":t},null,8,["table-name"])))),128))])};var et=c({components:{GraphTables:Za},setup(){const e=K(),a=O({}),t=O({});te("tablePositions",a),te("tableColumnPositions",t);const n=O(),o=e=>{var a;if(n.value){const{x:t,y:o}=null==(a=n.value)?void 0:a.getBoundingClientRect();return{x:(e.x-t-l.pan.x)/l.zoom,y:(e.y-o-l.pan.y)/l.zoom}}return{x:0,y:0}},s=e=>{var a,t;return r(i({},e),{x:Math.max(Math.min(Xa.cell*Math.round(e.x/Xa.cell),Xa.size/2-(null!=(a=e.w)?a:0)),Xa.size/-2),y:Math.max(Math.min(Xa.cell*Math.round(e.y/Xa.cell),Xa.size/2-(null!=(t=e.h)?t:0)),Xa.size/-2)})};te("snapToGrid",s);const l=ae({zoom:1,pan:{x:0,y:0}}),d={lastPosition:{x:0,y:0},lastGridPosition:{x:0,y:0},lockedOffset:{x:0,y:0},target:null,mousemove(e){const a=e.clientX-d.lastPosition.x,t=e.clientY-d.lastPosition.y;if(d.lastPosition={x:e.clientX,y:e.clientY},d.target){const e=d.target.position();if(d.target.grid){const n=s({x:a/l.zoom+Math.min(d.lastGridPosition.x,Xa.cell),y:t/l.zoom+Math.min(d.lastGridPosition.y,Xa.cell)});d.lastGridPosition.x=(d.lastGridPosition.x+(a/l.zoom-n.x))%Xa.cell,d.lastGridPosition.y=(d.lastGridPosition.y+(t/l.zoom-n.y))%Xa.cell,e.value=r(i({},e.value),{x:e.value.x+n.x,y:e.value.y+n.y})}else e.value=r(i({},e.value),{x:e.value.x+a,y:e.value.y+t})}else l.pan={x:l.pan.x+a,y:l.pan.y+t}},mouseup(){document.removeEventListener("mousemove",d.mousemove),document.removeEventListener("mouseup",d.mouseup)},mousedown(e){d.lastPosition={x:e.clientX,y:e.clientY},d.lastGridPosition={x:0,y:0},d.lockedOffset={x:0,y:0},document.addEventListener("mousemove",d.mousemove),document.addEventListener("mouseup",d.mouseup)},wheel(e){const a=l.zoom*Math.exp(-.2*Math.sign(e.deltaY)),t=o({x:e.clientX,y:e.clientY});if(a>.3&&a<5){l.zoom=a;const n=o({x:e.clientX,y:e.clientY});l.pan.x-=(t.x-n.x)*a,l.pan.y-=(t.y-n.y)*a}}};return te("controlls",d),U((()=>{l.zoom=e.state.graph.zoom,l.pan=e.state.graph.pan})),de((()=>[l.zoom,l.pan]),(()=>e.commit("setGraphZoomPan",{zoom:l.zoom,pan:l.pan}))),{graphConfig:Xa,svgRef:n,controlls:d,view:l,tableColumnPositions:t}}});const at=f("data-v-4f770632");N("data-v-4f770632");const tt=_("g",{id:"graph-path-layer"},null,-1);k();const nt=at(((e,a,t,n,o,s)=>{const l=w("graph-tables");return b(),m("svg",{ref:"svgRef",version:"1.1",xmlns:"http://www.w3.org/2000/svg",onMousedown:a[2]||(a[2]=(...a)=>e.controlls.mousedown&&e.controlls.mousedown(...a)),onWheel:a[3]||(a[3]=(...a)=>e.controlls.wheel&&e.controlls.wheel(...a))},[_("g",{transform:`matrix(${e.view.zoom}, 0, 0, ${e.view.zoom}, ${e.view.pan.x}, ${e.view.pan.y})`,x:"0",y:"0"},[_("g",null,[_("defs",null,[_("pattern",{id:"backgroundPatternSmall",width:e.graphConfig.cell,height:e.graphConfig.cell,patternUnits:"userSpaceOnUse"},[_("path",{d:`M ${e.graphConfig.cell} 0 L 0 0 L 0 ${e.graphConfig.cell}`,fill:"none","stroke-width":"2"},null,8,["d"])],8,["width","height"]),_("pattern",{id:"backgroundPattern",width:e.graphConfig.cellLarge,height:e.graphConfig.cellLarge,patternUnits:"userSpaceOnUse",x:"-0.5",y:"-0.5"},[_("rect",{width:e.graphConfig.cellLarge,height:e.graphConfig.cellLarge,fill:"url(#backgroundPatternSmall)"},null,8,["width","height"]),_("path",{d:`M${e.graphConfig.cellLarge} 0 L0 0 L0 ${e.graphConfig.cellLarge}`,fill:"none","stroke-width":"2"},null,8,["d"])],8,["width","height"])]),_("rect",{x:e.graphConfig.size/-2,y:e.graphConfig.size/-2,width:e.graphConfig.size,height:e.graphConfig.size,fill:"url(#backgroundPattern)",onMousedown:a[1]||(a[1]=a=>e.controlls.target=null)},null,40,["x","y","width","height"])]),tt,_(l)],8,["transform"])],544)}));et.render=nt,et.__scopeId="data-v-4f770632";var ot=c({components:{GraphRoot:et}});ot.render=function(e,a,t,n,o,s){const l=w("graph-root");return b(),m(l)};const st=[".db",".sqlite",".sqlite3"];function lt(e){if(!rt.state.database)return[];"string"==typeof e&&(e=rt.state.database.connection.prepare(e));const a=[];for(;e.step();)a.push(e.getAsObject());return a}function it({name:e,type:a,min:t,max:n,unique:o,primaryKey:s,notNull:l,default:i,foreign:r}){(t||n)&&(a+=t&&n?`(${t}, ${n})`:`(${n||t})`);const d=[`[${e}] ${a}`];return s&&d.push("PRIMARY KEY"),o&&d.push("UNIQUE"),l&&d.push("NOT NULL"),i.enabled&&i.value.length>0&&d.push(`DEFAULT ${i.value}`),r.column&&r.table&&d.push(`REFERENCES ${r.table}(${r.column})`),d.join(" ")}var rt=we({state:{sqlJs:null,database:null,tables:{},modifications:{},graph:{pan:{x:10,y:10},zoom:1,tables:{}}},mutations:{setSqlJs(e,a){e.sqlJs=a},setDatabase(e,a){e.database=a},setTables(e,a){e.tables=ye(a)},setColumns(e,{tableName:a,columns:t}){e.tables[a]&&(e.tables[a].columns=ye(t))},setModifications(e,a){e.modifications=ye(a)},setModification(e,{tableName:a,modified:t}){e.modifications[a]=ye(t)},setModifiedColumn(e,{tableName:a,columnName:t,column:n}){e.modifications[a].columns[t]=ye(n)},setModifiedData(e,{tableName:a,dataValue:t}){e.modifications[a].data=t},setModifiedDataUpdate(e,{tableName:a,columnName:t,rowNumber:n,updateValue:o}){n in e.modifications[a].data.updates||(e.modifications[a].data.updates[n]={}),e.modifications[a].data.updates[n][t]=o},setModifiedDataNew(e,{tableName:a,columnName:t,newIndex:n,updateValue:o}){e.modifications[a].data.new[n]||(e.modifications[a].data.new[n]=Object.fromEntries(Object.keys(e.tables[a].columns).map((e=>[e,null])))),t&&(e.modifications[a].data.new[n][t]=o)},deleteModifiedDataNew(e,{tableName:a,newIndex:t}){e.modifications[a].data.new.splice(t,1)},setModifiedDataDelete(e,{tableName:a,rowNumber:t}){e.modifications[a].data.delete.includes(t)?e.modifications[a].data.delete.splice(e.modifications[a].data.delete.indexOf(t),1):e.modifications[a].data.delete.push(t)},setGraphZoomPan(e,{zoom:a,pan:t}){e.graph.zoom=a,e.graph.pan=t},setGraphTablePosition(e,{tableName:a,position:t}){e.graph.tables[a]=t},resetState(e){console.log("state reset"),e.tables={},e.modifications={},e.graph.zoom=1,e.graph.pan={x:0,y:0}}},actions:{async createDatabase({commit:e,state:a}){a.sqlJs&&await window.$dialog.prompt("Enter the name for your database",{header:"Database name",initialPrompt:"no-name.db",onPositive:t=>{var n;t&&a.sqlJs&&(ut.push("/graph"),e("setDatabase",{name:t,connection:new a.sqlJs.Database}),e("setModifications",{}),window.$message.success(`Created new database '${null==(n=a.database)?void 0:n.name}'`))}})},async openDatabase({commit:e,state:a,dispatch:t}){var n;if(a.sqlJs){const o=await ce({mimeTypes:["application/vnd.sqlite3"],extensions:st,description:"SQLite Database"});ut.push("/graph");const s=new Uint8Array(await o.arrayBuffer()),l=new a.sqlJs.Database(s);e("resetState"),e("setDatabase",{connection:l,name:o.name,handle:o.handle}),t("queryTables"),window.$message.success(`Opened database '${null==(n=a.database)?void 0:n.name}'`)}},async saveDatabase({state:e,commit:a}){if(e.database){const t=new File([e.database.connection.export()],e.database.name,{type:"application/vnd.sqlite3"}),n=await me(t,{extensions:st,fileName:t.name},e.database.handle,!1);a("setDatabase",r(i({},e.database),{handle:n})),window.$message.success("Saved successfully")}},async queryTables({state:e,commit:a}){if(!e.database)return;const t=lt(e.database.connection.prepare("\n    SELECT name\n        FROM sqlite_master\n      WHERE type = 'table' AND\n            name NOT LIKE 'sqlite_%'\n      ORDER BY 1\n    ")).reduce(((e,{name:a})=>r(i({},e),{[a]:{columns:{},data:{updates:{},new:[],delete:[]},new:!1}})),{});a("setTables",t),a("setModifications",i(i({},t),pe(e.modifications,((e,a)=>a in t||e.new))))},async queryColumns({state:e,commit:a},t){var n,o;if(!e.database)return;const s=lt(e.database.connection.prepare(`\n    SELECT info.name AS name,\n           info.type AS type,\n           info.[notnull] AS [notNull],\n           info.dflt_value AS [default],\n           info.pk AS primaryKey,\n           fk_list.[table] AS foreignTable,\n           fk_list.[to] AS foreignColumn,\n           unique_info.name = info.name as [unique]\n      FROM pragma_table_info('${t}') AS info\n           LEFT JOIN\n           pragma_foreign_key_list('${t}') AS fk_list ON fk_list.[from] = info.name\n           LEFT JOIN\n           (\n               SELECT index_info.name\n                 FROM pragma_index_list('${t}') AS index_list\n                      JOIN\n                      pragma_index_info(index_list.name) AS index_info\n           )\n           AS unique_info ON unique_info.name = info.name;\n\n    `)).map((e=>{var a,t,n;const{type:o,max:s,min:l}=null!=(t=null==(a=e.type.match(/^(?<type>[a-zA-Z]+)(\(((?<min>\d+), )?(?<max>\d*?)\)$)?/))?void 0:a.groups)?t:{type:null,max:null,min:null};return{name:e.name,type:o,min:l?parseInt(l):null,max:s?parseInt(s):null,unique:!!e.unique,primaryKey:!!e.primaryKey,notNull:!!e.notNull,default:{value:null!=(n=e.default)?n:"",enabled:!!e.default},foreign:{table:e.foreignTable,column:e.foreignColumn},new:!1,drop:!1}})).reduce(((e,a)=>r(i({},e),{[a.name]:a})),{});a("setColumns",{tableName:t,columns:s});a("setModifications",r(i({},e.modifications),{[t]:{columns:i(i({},s),ve(null==(n=e.modifications[t])?void 0:n.columns,((e,a,t)=>a.drop?e:r(i({},e),{[a.name in s?a.name:t]:r(i({},a),{default:r(i({},a.default),{value:a.default.enabled?a.default.value:""}),new:!(t in s||a.name in s)})})),{})),data:null==(o=e.modifications[t])?void 0:o.data,new:!1}}))},async addModifiedColumn({commit:e,state:a},{tableName:t,columnName:n,column:o}){if(void 0===n){let e=0;do{e++}while(Object.keys(a.modifications[t].columns).includes(`Column ${e}`));n=`Column ${e}`}e("setModification",{tableName:t,modified:r(i({},a.modifications[t]),{columns:r(i({},a.modifications[t].columns),{[n]:i({name:n,type:"TEXT",min:null,max:null,unique:!1,primaryKey:!1,notNull:!1,default:{value:null,enabled:!1},foreign:{table:null,column:null},new:!0,drop:!1},o)})})})},async revertModifiedColumn({commit:e,state:a},{tableName:t,columnName:n}){e("setModifiedColumn",{tableName:t,columnName:n,column:a.tables[t].columns[n]})},async createModification({commit:e,state:a},t){let n=0;if(void 0===t)do{n++,t=`Table${n}`}while(t in a.modifications);return e("setModification",{tableName:t,modified:{columns:{},data:{updates:{},new:[],delete:[]},new:!0}}),t},async renameModification({commit:e,state:a},{tableName:t,newTableName:n}){e("setModifications",ve(a.modifications,((e,a,o)=>r(i({},e),{[o===t?n:o]:a})),{}))},async alterTable({state:e,dispatch:a,commit:t},{tableName:n,newTableName:o,columns:s}){if(!e.database)return;void 0===s&&(s=e.modifications[n].columns);const l=Object.entries(s).filter((([,e])=>!e.drop&&!e.new)).map((([e,a])=>({old:e,new:a.name}))),d=`${n}__red_sqluirrel`,u=[];u.push("BEGIN TRANSACTION;"),u.push(`CREATE TABLE [${d}] AS SELECT * FROM [${n}];`),u.push(`DROP TABLE [${n}];`),u.push(`CREATE TABLE [${null!=o?o:n}] (\n      ${Object.values(s).filter((e=>!e.drop)).map(it).join(", ")}\n    );`),l.length&&u.push(`INSERT INTO [${null!=o?o:n}] (\n        ${l.map((e=>`[${e.new}]`)).join(", ")}\n      ) SELECT ${l.map((e=>`[${e.old}]`)).join(", ")}\n          FROM [${d}];`),u.push(`DROP TABLE [${d}]`),console.log(u.join("\n\n"));try{e.database.connection.run(u.join("\n\n")),e.database.connection.run("COMMIT;")}catch(c){console.log("has error",c),e.database.connection.run("ROLLBACK;")}o&&t("setModifications",r(i({},fe(e.modifications,[n])),{[o]:e.modifications[n]})),await a("queryTables"),o||await a("queryColumns",n)},async createTable({state:e,dispatch:a,commit:t},{tableName:n,columns:o}){if(!e.database)return;void 0===o&&(o=e.modifications[n].columns);const s=[];s.push("BEGIN TRANSACTION;"),s.push(`CREATE TABLE [${n}] (\n      ${Object.values(o).filter((e=>!e.drop)).map(it).join(", ")}\n    );`);try{e.database.connection.run(s.join("\n\n")),e.database.connection.run("COMMIT;")}catch(l){console.log("has error",l),e.database.connection.run("ROLLBACK;")}await a("queryTables"),await t("setModification",{tableName:n,modified:r(i({},e.modifications[n]),{new:!(n in e.tables)})}),await a("queryColumns",n)},async renameTable({dispatch:e,state:a},{tableName:t,newTableName:n}){t!==n&&await e("alterTable",{tableName:t,newTableName:n,columns:a.tables[t].columns})},async dropTable({state:e,dispatch:a},t){e.database&&(e.database.connection.run(`DROP TABLE ${t}`),await a("queryTables"))},async alterTableData({state:e,commit:a},{tableName:t,data:n}){if(!e.database)return;if(void 0===n&&(n=e.modifications[t].data),void 0===n)return;const o=[];o.push("BEGIN TRANSACTION;");const s=Object.keys(n.updates).filter((e=>!(null==n?void 0:n.delete.includes(+e)))).map((e=>+e));for(const i in n.delete)o.push(`DELETE FROM [${t}] WHERE ROWID = ${n.delete[i]};`);for(const i in s)o.push(`UPDATE [${t}] SET ${Object.entries(n.updates[+s[i]]).map((([e,a])=>`[${e}] = ${"string"==typeof a?'"'+a+'"':a}`)).join(", ")} WHERE ROWID = ${s[i]};`);for(const i in n.new)o.push(`\n        INSERT INTO [${t}] (${Object.keys(n.new[i]).map((e=>`[${e}]`)).join(", ")})\n          VALUES (${Object.values(n.new[i]).map((e=>`${"string"==typeof e?'"'+e+'"':e}`)).join(", ")});\n      `);console.log(o.join("\n"));try{e.database.connection.run(o.join("\n\n")),e.database.connection.run("COMMIT;"),a("setModifiedData",{tableName:t,dataValue:{updates:{},new:[],delete:[]}})}catch(l){console.log("has error",l),e.database.connection.run("ROLLBACK;")}}},getters:{tableNames(e){if(e.database)return Object.keys(e.tables)},tableModified:(e,a)=>t=>{var n,o,s;return be(null==(n=e.modifications[t])?void 0:n.columns).some((e=>a.columnModifications(t,e)))||!he(be(null==(o=e.tables[t])?void 0:o.columns),be(null==(s=e.modifications[t])?void 0:s.columns))},columnModifications:e=>(a,t)=>{var n;const o=null==(n=e.modifications[a])?void 0:n.columns[t];if((null==o?void 0:o.new)||(null==o?void 0:o.drop))return!0;{const n=ge(e.tables[a],["columns",t],o);return!he(r(i({},o),{default:{enabled:null==o?void 0:o.default.enabled,value:(null==o?void 0:o.default.enabled)?o.default.value:null}}),r(i({},n),{default:{enabled:null==n?void 0:n.default.enabled,value:(null==n?void 0:n.default.enabled)?n.default.value:null}}))}}}});const dt=[{path:"/",name:"Home",component:Ia,beforeEnter(e,a,t){rt.state.database?t("/graph"):t()}},{path:"/graph",name:"Graph",component:ot},{path:"/about",name:"About",component:()=>Sa((()=>import("./About.a0fbe5e1.js")),["assets/About.a0fbe5e1.js","assets/vendor.bae2ebbb.js"])},{path:"/table/:name",name:"Table",component:()=>Sa((()=>import("./Tables.60bf0d57.js")),["assets/Tables.60bf0d57.js","assets/vendor.bae2ebbb.js"]),children:[{path:"data",name:"TableData",meta:{title:()=>`Table - ${ut.currentRoute.value.params.name} / Data`},component:()=>Sa((()=>import("./Data.643d7192.js")),["assets/Data.643d7192.js","assets/Data.e6a0d63a.css","assets/vendor.bae2ebbb.js"]),props:!0},{path:"columns",name:"TableColumns",meta:{title:()=>`Table - ${ut.currentRoute.value.params.name} / Columns`},component:()=>Sa((()=>import("./Columns.797a9c6d.js")),["assets/Columns.797a9c6d.js","assets/Columns.88f63874.css","assets/vendor.bae2ebbb.js"]),props:!0}]}],ut=xe({history:$e("/"),routes:dt});let ct=!1;window.addEventListener("keydown",(e=>ct="Backspace"===e.key)),window.addEventListener("keyup",(()=>ct=!1)),ut.beforeEach(((e,a,t)=>{ct?t(!1):t(),ct=!1})),ut.beforeEach(((e,a,t)=>{var n,o;(null==(n=e.name)?void 0:n.toString().startsWith("Table"))?e.params.name in rt.state.modifications?"Table"===e.name?t(r(i({},e),{name:"Table"!==a.name&&(null==(o=a.name)?void 0:o.toString().startsWith("Table"))&&!rt.state.modifications[e.params.name].new?a.name:"TableColumns"})):t():t("/"):t()})),ut.afterEach((e=>{const a=[];rt.state.database&&a.push(rt.state.database.name);const t="function"==typeof e.meta.title?e.meta.title():e.meta.title;a.push(t||e.name),document.title=`${a.join(" / ")} - Web Edit DB`})),function(e={}){const{immediate:a=!1,onNeedRefresh:t,onOfflineReady:n}=e;let o,s;if("serviceWorker"in navigator){o=new d("/sw.js",{scope:"/"}),o.addEventListener("activated",(e=>{e.isUpdate||null==n||n()}));{const e=()=>{null==t||t()};o.addEventListener("waiting",e),o.addEventListener("externalwaiting",e)}o.register({immediate:a}).then((e=>s=e))}}({});const mt=Ne(Ca);mt.use(rt),mt.use(ut),mt.mount("#app");export{De as _,je as a,ze as b,Te as c,Se as d,Ge as e,qe as f};
